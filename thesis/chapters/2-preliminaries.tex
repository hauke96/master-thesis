% !TEX root = ../thesis.tex
% !TeX spellcheck = en_US

\section{Geospatial data}

	According to the ISO standard 19109:2015\cite{geolexica-202}, the term \term{geospatial data} refers to \enquote{data with implicit or explicit reference to a location relative to the Earth}.
	In other words, data with addresses, coordinates or other location references belong to the class of geospatial data.
	
	Typical examples are customer databases, where each customer has an address, or weather measurement data, where each data point has a coordinate, altitude and timestamp.
	Latter therefore belongs to \term{spatiotemporal data}, because is has an additional time dimension.
	Since addresses are not globally standardized, describe only a vague location and usually belong to a hole area, they are of less importance for this thesis.
	Next to the mentioned explicit references to locations, implicit references can be encoded within metadata of datasets.
	This is for example the case for the GeoTIFF format, storing location data in the matadata of a normal TIFF file\cite{ogc-geotiff}.
	The exact coordinate of a data point (in this case a pixel in the TIFF image), must then be calculated using this matadata.

	\subsection{Coordinate reference systems and projections}
	
		Usually coordinates are used to specify exact locations in a specific domain (usually on the surface of the Earth).
		Unfortunately the Earth is not a perfect sphere but rather an ellipsoid.
		But even this ellipsoid is not smooth and has slightly different radii in different regions.
		Furthermore, parts of the surface move relative to each other (continental drift) and therefore change the coordinates of whole regions.
		Even though, the continental plates move slowly, this effect adds up to a significant distance rendering accurate measurements potentially useless\cite[7]{ordenance-survey-booklet}.
		These properties of the surface of Earth make it necessary to have a variety of different reference systems and projections for spatial data.
		
		A \todo{check this whole CRS thing for correctness}\term{coordinate reference system} (CRS) defines the combination of a coordinate system and an approximation of the surface of the Earth.
		The \term{coordinate system} defines, like a mathematical coordinate system, the extend and unit of coordinates.
		Types of coordinate systems are for example cartesian (with meters or foot as unit) and ellipsoidal (with latitude and longitude in degrees)\cite[11-13]{ordenance-survey-booklet}.
		The \term{horizontal datum} (also \term{Terrestrial Reference System} or \term{geodetic datum}) defines the origin and orientation of the coordinate system and is therefore a mapping from coordinate to location on Earth based on a specific ellipsoid.
		Depending on this ellipsoid, the datum either defines a global or local reference system.
		Latter is more accurate in certain places while a global system tries to find a good approximation for every location on Earth.
		For two dimensional Cartesian coordinate systems, a \term*[map projection]{projection} is needed to turn each  spherical location to a two dimensional planar coordinate\cite[17]{ordenance-survey-booklet}.
		
		For visualization purposes, a \term{map projection} turns coordinates of a specific CRS into flat and two dimensional coordinate for a map.
		This may be a different projection as used in a two dimensional Cartesian CRS and transformations between different CRS are needed.
		This visualizing map projection is independent of the data but has a strong effect on the visualization.\todo[inline]{Visualization part is a bit clumsy ...}

	\subsection{Data structures}
	
		Spatial data can have a variety of data structures.
		Some of these are used in many or all frameworks and formats, but some are vendor specific.
		This section gives an overview of common data structures in spatial data.
		Because of a variety of vendors and standards, the GeoJSON standard is used as reference here\citationNeeded.
		
		The first concepts to consider are geometries and features.
		
		% TODO Reference https://www.ogc.org/standards/sfa for geometry types
		A \term{geometry} just represents geometric coordinates and their relation to each other.
		The simplest geometry is a \texttt{Point} with one coordinate.
		Ordering multiple points turns them into a \texttt{LineString} with a certain direction.
		A closed \texttt{LineString} is called \texttt{Polygon} and describes an area.
		Multiple geometries of the same kind can be collected forming a \texttt{MultiPoint}, \texttt{MultiLineString} or \texttt{MultiPolygon}.
		Polygons have an additional property:
		Putting polygons inside polygons forms \enquote{holes} and \enquote{islands}.
		
		A \term{feature} represents a real world object (for example a tree, road or lake) and therefore consists of a geometry.
		Additionally, features have properties describing the kind of object they represent.
		Such properties are -- in the case of GeoJSON -- not further defined and can contain arbitrary values.
		Some file formats, however, restrict the length or set of allowed characters (\todo[inline]{see shapefile below}) while others try to standardize the allowed keys and values.
		The OpenStreetMap Wiki tries to define a community driven standard\todo{cite proposal page} while the INSPIRE standard of the EU defines fixed key and values for attributes (for example \texttt{natureConservation} is one value for the \texttt{SiteProtectionClassification} property)\cite[31]{inspire-protected-sites}.
	
	\subsection{File formats}
	\label{subsec:file-formats}
	
		Spatial data can be stored in a variety of different file formats with different properties and use cases.
		Next to proprietary formats, there are many open standards.
		The \term[ogc]{Open Geospatial Consortium} (OGC) published open standard definitions and schemas for some of these open file formats.		
		This section gives an overview of some popular formats:
		
		\subsubsection{Esri shapefile}
		
			The \term[shapefile]{Esri Shapefile} format was developed in the 1990s and is a popular file format and used for example in Esri products like the ArcGIS platform.
			Each shapefile actually consists of multiple files on disk\cite{esri-shapefile-file-ext-spec}.
			Three of them are mandatory containing the geometries (\texttt{.shp}), an index (\texttt{.idx}) and a dBASE table with attributes (\texttt{.dbf}).
			Additional files are optional and can contain additional indices or details about the CRS.
			Even though shapefiles are very popular\cite[356]{spatial-file-formats-trends}, there are several limitations regarding the containing geometries and attributes.
			Only one type of geometry is supported per shapefile, which means a shapefile cannot contain points and polygons at the same time.\citationNeeded
			Attributes also have limitations in their size and structure, for example are the attribute keys limited to 10 and values to 254 characters\cite{esri-shapefile-limitations}.
			The default CRS is based on latitudes and longitudes using the NAD 27 datum\cite{esri-shapefile-coordinate-system}.
			
		\subsubsection{KML}
		
			Another popular spatial format is the \term[kml]{Keyhole Markup Language} (KML), which was standardized by the OGC in 2008\cite{ogc-kml-2.2}.
			A KML file consist of a single XML structured file.
			Since it follows the XML standard, which is plain text, geometry and attribute count and lengths are irrelevant.
			KML files may contain more information than just features:
			Features can be grouped and hirarchically organized, temporal data can be added to define a lifetime of a feature and camera views for visualization applications can be defined\cite{ogc-kml-2.3}.
			The CRS can be specified but WGS 84 with latitudes and longitudes is used by default.
		
		\subsubsection{GeoJSON}
		
			Another open but not OGC standardized format is \term{GeoJSON}.
			As the name suggests, a GeoJSON file is valid JSON following the structure defined in \href{https://datatracker.ietf.org/doc/html/rfc7946}{RFC7946}\cite{ietf-geojson}.
			The file may contain a collection of geometries or features but can also just contain a single geometry or feature.
			As in KML files, the length, character choice and amount of attributes or geometries are not restricted.
			The CRS has been set to WGS 84.
			
		\subsubsection{GeoTIFF}
		
			All formats mentioned so far are store vector data, however, raster data can be georeferenced as well.
			One format to store such raster data in form of an image, is the OGC standardized \term{GeoTIFF} format.
			As the name suggests, it is an TIFF formatted image with spatial metadata such as the CRS and a mapping of pixel to coordinates\cite{ogc-geotiff}.
			Typical use cases for such images are aerial or satellite imagery and digital elevation models (DEM).
			
		\subsubsection{Other formats}
		
			\todo[inline]{Citations needed}
		
			There are many more formats for numerous use cases ranging from simple unstandardized to complex, feature rich and fully standardized formats.
			
			A \term{CSV} file can also serve as a spatial file format where certain columns contain geographical information.
			However, there is no popular standard using CSV files for geodata.
			
			The \term{well known text} (\term*{WKT}) format is a simple text based format used to store spatial data for example in databases.
			It also exists in a binary version (called \term*{WKB}), which consumes less space.
			
			More complex formats are \term{SpatiaLite} and \term{GeoPackage}.
			SpatiaLite specifies an extension to file based SQLite database and offers additional geodata specific functionality\cite{spatialite-website}.
			The GeoPackage is based on an SQLite database as well but diverged from the SpatiaLite format, for example by using a different WKB encoding\cite{geopackage-faq}.
			
			Next to these local and file based formats, there are web based standards as well.
			The OGC also standardized some APIs for web based services.
			Popular standards are the \term{Web Map Service} (\term*{WMS}), \term{Web Map Tile Service} (\term*{WMTS}) and \term{Web Feature Service} (\term*{WFS}).
	
	\subsection{GIS}
	
		A file format alone, as described in the \hyperref[subsec:file-formats]{previous section}, is only useful when it comes to storing or transferring data or ensuring interoperability.
		Processing the data is part of applications referred to as \term[geographic information system]{geographic information systems} (\term*{GIS}).
		
		The term GIS is very broad and describes nearly all systems working with spatial data.
		This includes databases like Postgres with the PostGIS extension, processing tools like GDAL, libraries like the Net Topology Suite, servers like GeoServer and desktop applications like ArcMap or QGIS.
		Latter often combine multiple functionalities for visualization, processing and analysis purposes.
	
	\subsection{OpenStreetMap}
	
		\term{OpenStreetMap} (\term*{OSM}) is a geospatial database that is maintained by a global community and licensed under the \term{Open Data Commons Open Database License} (\term*{ODbL})\cite{osm-wiki-about}.
		It can therefore be used, changed and redistributed as long as a proper attribution is given and results stay under the ODbL\cite{odbl-summary}.
		In 2006, two years after the OSM project started, the OpenStreetMap Foundation was established to perform fund-raising, maintain the servers and also act as a legal entity.
		People contributing to OSM are called \textit{mappers} or simply \textit{contributors}.
		Most of them are volunteers, often mapping their local vicinity or concentrating on specific topics, but a significant amount of changes are contributed by companies with payed mappers\cite{osm-corporate-mappers}.
		
		\subsubsection{Data model}
		
			The model of OSM is much simpler compared to many of the \hyperref[subsec:file-formats]{above mentioned} data formats.
			There are two basic geometry types called \term{node} and \term{way} which are the same as for example \texttt{Point} and \texttt{LineString} in the GeoJSON format \todo{or OGC context?}\cite{osm-wiki-data-model}.
			Closed ways, where the first and last coordinate are equal, form an \term{area} or -- in GeoJSON terminology -- a \texttt{Polygon}.
			A third type, called \term{relation}, can be used to combine multiple other geometries into a new feature.
			This can be used to form multi-polygons or other entities built up from several features, like turn restrictions or bus routes.
			
		\subsubsection{Attributes}
			
			Attributes are called \term[tag]{tags} and are simple unrestricted key-value pairs.
			Most tags describe the properties of the feature.
			For example a node can have tags making it a restaurant with additional tags for the name, address, the food to get there, the opening hours and if the toilets are barrier free or not.
			
			Some tags, however, like \texttt{area=[yes|no]} or the \texttt{type} key for relations, influence the type of geometry.
			A closed way with \texttt{area=no} does in fast \textit{not} form an area or polygon, but is just a closed line.
			This of course affects visualizations but may also need to be considered in other processing and analysis tasks.
			
			Other tags add metadata to objects, for example the last time the feature was checked, the source or internal notes to other mappers.
			
			There are two ways a combination of key and value becomes an \enquote{official} tag:
			By using it so often that it is de-facto accepted or by a proposal and vote.
			The proposal process tries to organize and professionalize the development of new tasks.
			Not only is a new tagging scheme accepted or rejected by a democratic vote, a mandatory discussion needs to take place earlier.
			Due to the vast amount of contributors, different opinions, different editors and different knowledge about the tagging schemes, sometimes two or more competing schemes evolve (for example \texttt{phone=*} and \texttt{contact:phone=*}).
			Tagging schemes change over time and some may become deprecated, leading to outdated tags on objects.
			
		\subsubsection{Contributions to OSM}
		
			Uploads to OSM always happen in so called \term[changeset]{changesets} combining multiple changed on the map\cite{osm-wiki-changeset}.
			Each changeset can have tags, just like features can.
			However, tags on a changeset specify certain metadata to the change.
			The \texttt{created\_by}, \texttt{comment} and \texttt{source} tags are the most common ones but more details can be added and depends on the editor.
			
			Because some mappers also perform manual quality assurance, each changeset should fulfill certain quality criteria.
			The simplest one is a good changeset comment answering questions like \textit{what changed?} and \textit{why was the change necessary?}.
			For legal reasons, specifying the source is very important since the ODbL is not necessarily compatible with licenses of other data sources.
			Ideally a changeset should be coherent, which means that it should focus on one thematic aspect in one local area.
			Too large and crowded changesets are difficult to maintain.
			
		\subsubsection{Data contained in OSM}
		
			Since OSM has no focus on specific topics, nearly anything can be added to OSM.
			However, there are some types of features that are very common\cite{taginfo-keys}.
			
			The most common objects are buildings with over 542 million occurrences\footnote{All occurrence statistics as of \DTMDate{2023-01-03}.}.
			In fact 6\% of all objects and nearly 60\% of all ways in OSM are buildings.
			Highways (mainly roads and streets but also paths, bridleways, railways and more) are the second common type of features with over 233 million occurrences.
			Addresses are also very common, about 32\% of all nodes and 7\% of all ways have a house number.
			Other area features like forests or lakes exist a lot as well as line features like barriers and waterways.
			
			\todo[inline]{Describe data relevant for this thesis?}
			
		\subsubsection{Data \textit{not} contained in OSM}
		
			Even though, the tagging scheme can be extended arbitrarily, some data will probably not be added to OSM.
			This can have multiple reasons.
			
			First, some data is too detailed and therefore people will not invest the time necessary to create that data.
			Second, OSM follows some strategies on what to add and what not.
			One important strategy is the verifiability of objects on the ground.
			Anyone visiting a certain place should be able to find the data from OSM and therefore verify its existence and correctness.
			Third, temporary data should not be added since OSM is not a real-time database.
			However, there's not a strict definition when a feature is temporary and when it is (potentially) permanent.
			And fourth, data under a uncompatible license will not be added.
			This also includes data from many public authorities and nearly all companies.
			
			Unfortunately, data relevant to routing is often added to roads and paths only but not to areas.
			This includes primarily accessibility and surface information.
			However, latter can potentially be inferred or approximated from other tags on a polygon, for example \texttt{surface=grass} can be interred from \texttt{natural=grassland} and \texttt{access=yes} from \texttt{place=square}.
			
			Private areas, however, do often not exist at all or have very little details.
			This is mainly due to reason two from above and rooted in a common sense of privacy towards companies and residents.
			But also the areas in question are often not accessible to everyone, rendering them unverifiable for unauthorized people.

\section{Routing}

	% fastest, shortest path, all shortest...
	
	\subsection{Theoretic considerations}
	
		Formally, routing describes the process of finding an optimal path within a graph $G=(V, E)$ from a start location $s$ to a target location $t$ with $s, t \in V$.
		A path is an ordered list of connected vertices $p=\left\langle v_0, v_1, \dots v_n \right\rangle$, so for an edge $(v_i, v_j)$ of consecutive vertices, $(v_i, v_j) \in E$ must hold.
		
		Often, \enquote{optimal} means shortest, whereby the length of an edge is considered as arbitrary weight and is therefore not bound to geographic lengths of edges.
		In theoretic computer science, the fundamental problem behind routing algorithms is the \term{shortest-path problem}.
		However, the shortest path problem exists in several variants\cite[644]{cormen-introduction-to-alg}:
		
		\subsubsection{Single-source shortest-paths}
		
			One source vertex is given and the shortest paths to all other vertices should be determined.
			This is the most common problem for real world applications as it solves or strongly relates other problems described below.
			
			\todo[inline]{Algorithms}
		
		\subsubsection{Single-destination shortest-paths}
		
			This is the opposite to the above problem.
			All shortest paths to a specific vertex from any other vertex should be found.
			
			However, no new algorithms are needed to solve this problem.
			Instead, the direction of each edge can be reversed turning this problem into the single-source problem.
		
		\subsubsection{Single-pair shortest-paths}
		
			Like the single-source but shortest paths from one source to one target vertex are requested.
			This problem is solved once the single-source problem has been solved.
		
		\subsubsection{All-pair shortest-paths}
		
			This problem is similar to the single-pair problem but is not restricted to a single source vertex.
			A naive approach would be to use an algorithm solving the single-pair problem on each vertex, but there are faster ways to solve this.
			However, since this problem has no relevance for this section and thesis, this problem is not discussed in further details.
	
	\subsection{Routing strategies}
	
		\subsubsection{Graph based}
		
		\subsubsection{Geometric}

\section{Agent based systems and simulations}