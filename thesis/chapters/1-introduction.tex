% !TEX root = ../thesis.tex
% !TeX spellcheck = en_US

\section{Motivation}
	
	% finding good routes is difficult, solved using A*/Dijkstra on networks
	Traveling through a network of roads and paths often requires the use of a computer systems determining the optimal route from a source to a destination location.
	The software used to solve this problem is often called a \emph{routing engine} and uses shortest-path algorithms on graphs to find the shortest path.
	A graph is used as the central data structure to abstract the real world into vertices and edges, which are points connected by lines representing roads and ways.
	Such graphs can represent non-physical networks as well, for example trading relationships between countries, social media networks or routers in the internet.
	However, this thesis only considers graphs representing road networks.
	
	Graphs representing road networks only build an abstraction of the real world.
	Detailed information regarding the geometry and infrastructure, such as the width or number of lanes, are usually added via attributes (usually key-value pairs) describing these properties.
	
	Algorithms for network-based routing, like the popular Dijkstra and A* algorithms, are well understood, optimized and used in numerous scientific and real world applications.
	Over the last decades, optimizations and the use of more efficient data structures lead to further performance enhancements making it possible to use such routing algorithms on large scale networks.
	Even though, the performance is good enough for larger networks, like the road network of the USA \cite{aviram-optimizing-dijkstra}, requests in dense networks or of global scale are still a problem.
	To solve this, several speed up methods exist decreasing query times, which will be covered later in \cref{subsec:speedup-methods}.
	Using such techniques enables global routing request being processed within milliseconds\footnote{Tested for a routing request from Hamburg, Germany to Beijing, China on \href{https://www.openstreetmap.org/directions?engine=fossgis\_osrm\_car&route=53.55\%2C10.00\%3B39.91\%2C116.39}{openstreetmap.org} using the OSRM car profile which is based on Contraction Hierarchies (s. \cref{subsubsec:ch}). The HTTP request returned the result in under 215ms -- including network latency of several milliseconds.}
	
	Next to line-based shapes, which are very suitable for routing, the real world also consists of polygonal shapes like market places, parking lots or parks.
	Classical routing algorithms can only interpret the outer edges of these polygons as closed lines and therefore only find paths along these outer edges.
	Often auxiliary paths are added to connect opposite sides of polygons enabling routing algorithms to cross these areas.
	This is a common practice in OpenStreetMap, a crowdsourced geospatial database, for example at the Rathausmarkt (town hall market) in Hamburg, Germany \footnote{Auxiliary ways were added inside the closed OpenStreetMap-way  \href{https://www.openstreetmap.org/way/142944433}{142944433}.}.
	Lower amounts of lines can be added quite easily by hand, but manually filling large areas or even a whole city with these auxiliary paths is not feasible.
	Fortunately, there are algorithms filling open spaces with edges as well as algorithms finding paths through open spaces without any additional edges.
	Both strategies are covered below but also described in detail in following chapters.
	
	% problem: Most real world destinations are not on the network
	Another problem, similar to routing through open spaces, arises with the source and destination locations of real world routing.
	Because things like addresses, \term*{points of interest} (POIs) and manually chosen locations are not part of roads or ways, they are rarely part of the underlying routing graph.
	Even though there are algorithmic approaches to connect points to a graph (e.g. by searching for the nearest vertex or by taking some intermediate location on an edge), these simple approaches are often inaccurate.
	Such inaccuracies exist due to the space between an arbitrary location and the actual road network, which can contain numerous obstacles, such as walls or buildings.
	Therefore, a walkable or drivable connection might not even exist at all, for example if the routing destination is located inside a lake.
	
	% alternative: geometric routing avoiding obstacles
	Next to graph-based routing algorithms, pure geometric routing approaches exist to determine shortest paths among obstacles in open spaces.
	Obstacles are geometries that cannot be passed under normal circumstances, like for example buildings, fences, lakes and walls.
	There are two main strategies to solve this type of shortest path problem \cite{hershberger-suri}:
	
	The first approach generates an auxiliary network around these obstacles (just like the auxiliary paths mentioned above) and then uses a graph-based shortest path algorithm to find the actual path.
	There are several different approaches on how to generate a graph and all have different properties \cite{graser-osm-open-spaces}.
	\Cref{subsec:visibility-graph} covers them in more detail.
	
	The second approach does not create such a graph but stores its shortest path information for each source vertex in a map.
	Each shortest path map is made for a specific source vertex and consists of several distinct regions.
	Every location within such region has the same predecessor on the shortest path from the source vertex to this location.
	In other words, all paths from a source vertex to any location inside one region go from the source via other vertices to the predecessor of the region and from there directly to the destination location.
	Recursively following back all predecessors to the source vertex gives the shortest path to a given location.
	This approach is also called the \term{continuous dijkstra} paradigm and will be described in detail in \cref{subsec:continuous-dijkstra}.
	
\section{Problem and contributions}

	The previous section mentions one of the disadvantages of network-based routing:
	Source and destination locations are probably not on the graph.
	Furthermore, trajectories of pedestrians in the real world are often not following edges on routing graphs, which is especially the case for insufficiently connected open spaces.
	Routes strictly following the edges of a graph are therefore inaccurate for pedestrian routing \cite{graser-osm-open-spaces}.
	Such inaccurate routes significantly affect the user experience of real world programs as well as numerous other use cases like agent-based simulations.

	This thesis solves these issues by proposing, implementing and evaluating a hybrid routing algorithm that combines the accuracy of geometric routing using visibility graphs with the optimizations and wide use of network-based routing.
	Determining shortest paths using the resulting approach is fast, enables the use of common speed up techniques, easy to implement and reaches all accessible vertices on the graph.
	Any other arbitrary location, for example a location chosen by the user, can be added to the graph quite easily.
	Real world applications as well as simulations, such as multi-agent simulations of pedestrian behavior, benefit from this algorithm.
	
\section{Structure of this thesis}

	First, the basics of spatial data, data formats, graph routing, geometric routing and agent-based simulations are covered in \cref{chap:fundamentals}.
	The scientific work related to this thesis is presented in \cref{chap:related-work} for graphs and networks, routing techniques and pedestrian path finding in particular.
	\Cref{chap:design} describes the design of the system developed for this thesis and gives an overview of the different components and elements.
	A more detailed view of the implementation is given in \cref{chap:implementation} describing the technical aspects of combining network and geometric routing as well as the frameworks that were used.
	The hybrid solution is then evaluated in \cref{chap:evaluation} regarding performance, correctness and quality of the resulting routes.
	
% TODO Spatial pruning as in "A Modular Routing Graph Generation Method for Pedestrian Simulation"?